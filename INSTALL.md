The Haskell Tool Stack - утилита для работы с Haskell проектами
===

Установка (Windows)
---

Проходим по [*ссылке*](https://docs.haskellstack.org/en/stable/install_and_upgrade/) и скачиваем нужную версию и устанавливаем.

Теперь в консоли доступна команда **stack**.

stack позволяет:

1. Разворачивать инфраструктуру.
1. Собирать проекты.
1. Устанавливать библиотеки.

Haskell-инфраструктура — экосистема, в основе которой лежит компилятор **GHC** (Glasgow Haskell Compiler).
Haskell является компилируемым языком: приложение представляет собой обыкновенный исполняемый файл.
Haskell-проект — среда для создания приложений и библиотек.
Haskell-библиотеки — готовые решения (модули), импортируемые в проект.

Разворачивание инфраструктуры
---

В консоли набираем:

>***C:\Users\User> stack setup***

В итоге получаем установленную инфраструктуру. Располагается всё в корневой директории в папке sr:
в моёс случае это: C:\sr. Больше данной командой пользоваться не придётся - один раз развернули ифраструктуру и используем всегда.

Следующим действием используем команду stack update:

>***C:\Users\User> stack update*** - обновление до последней стабильной версии.

Команда stack init - выполняется при использовании уже существующих Haskell проектах, но также необходима, если в дальнейшем есть желание устанавливать расширения для текстовых редакторов или консоли (Прим.: intero из расширения haskero для VSCOde).

>***C:\Users\User> stack init***

Для использования ghc и ghci из консоли необходимо добавить пременные среды. Для этого:

*Панель управления\Система и безопасность\Система Выбираем Д-ополнительные параметры системы\Переменые среды -> Заходим в path.*

Добавляем путь до ghc-8.2.2\bin, пример:

*C:\Users\UserName\AppData\Local\Programs\stack\x86_64-windows\ghc-8.2.2\bin*

Создание и сборка проекта:
---

После устанвоки stack и развёртывания инфраструктуры можно создать проект.

1. Перходим в любую, созданную нами директорию, где будут храниться наши проекты и из выполняем:

>***C:\Users\User\Documents\myProject> stack new firstProject***, где firstProject - имя проекта.

В результате получим каталог firstProject, содержимое которого выглядит следующим образом:

```.
├── app
│ └── Main.hs <- Главный модуль программы
├── LICENSE
├── README.md
├── firstProject.cabal <- Сборочный конфиг проекта
├── Setup.hs
├── src
│ └── Lib.hs <- Ещё один модуль
├── stack.yaml <- Конфиг Stack
└── test
└── Spec.hs <- Тесты, они нам пока не нужны
```

2. Переходим в каталог firstProject и производим сборку проекта:

>***C:\Users\User\Documents\myProject\firstProject> stack build***

В итоге получаем файл firstProject-exe, хранящийся внутри скрытого каталога .stack-work
в корне проекта.

Запуск
---

Для запуска данного файла используем:

>***C:\Users\User\Documents\myProject\firstProject> stack exec firstProject-exe***

Команда stack exec запускает программу внутри stack-окружения. Чтобы упростить себе жизнь можно выполнить команду:

>***C:\Users\User\Documents\myProject\firstProject> stack install***

Результат данной команды - копирование файла local/bin (Если данного каталога не имеется, то придётся создать его). 
Также добавим local/bin в path: C:\Users\UserName\AppData\Roaming\local\bin

Теперь программу можно запускать из консоли следующим образом:

>***C:\ firstProject-exe***

Использование готового проекта Haskell ()

1. Клонируем репозиторий (используем любые интсрументы для Windows: git bash, лтбо SourceTree)

2. Из директории репозитория выполняем команды:

      - C:\Users\User\repository> git init

      - C:\Users\User\repository> git build

4. Запускаем main (адрес файла будет в выводе stack build).

Больше информации о Stack и Stackage вы найдете по следующим ссылкам:

- <https://docs.haskellstack.org/en/stable/README/>
- <https://www.stackage.org/>
- <https://github.com/fpco/stackage>
- <https://github.com/commercialhaskell/stack>